[2025-02-27T10:50:25.173+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T10:50:25.182+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T10:50:25.182+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T10:50:25.204+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T10:50:25.209+0000] {standard_task_runner.py:57} INFO - Started process 183 to run task
[2025-02-27T10:50:25.218+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp4r4_8kzy']
[2025-02-27T10:50:25.245+0000] {standard_task_runner.py:85} INFO - Job 6: Subtask create_velib_station_status_table
[2025-02-27T10:50:25.377+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 5869344327a9
[2025-02-27T10:50:25.509+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T10:50:25.509+0000] {sql.py:262} INFO - Executing: 
            CREATE TABLE IF NOT EXISTS velib_stations(
                station_id BIGINT PRIMARY KEY,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT
            );
            
[2025-02-27T10:50:25.519+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T10:50:25.642+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T10:50:25.646+0000] {sql.py:375} INFO - Running statement: 
            CREATE TABLE IF NOT EXISTS velib_stations(
                station_id BIGINT PRIMARY KEY,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT
            );
            , parameters: None
[2025-02-27T10:50:25.661+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T105025, end_date=20250227T105025
[2025-02-27T10:50:25.698+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T10:50:25.728+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T10:59:31.198+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T10:59:31.205+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T10:59:31.205+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T10:59:31.218+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T10:59:31.221+0000] {standard_task_runner.py:57} INFO - Started process 183 to run task
[2025-02-27T10:59:31.229+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpfo2bkv2_']
[2025-02-27T10:59:31.246+0000] {standard_task_runner.py:85} INFO - Job 5: Subtask create_velib_station_status_table
[2025-02-27T10:59:31.356+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 3d206dcce365
[2025-02-27T10:59:31.487+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T10:59:31.488+0000] {sql.py:262} INFO - Executing: 
            CREATE TABLE IF NOT EXISTS velib_stations(
                station_id BIGINT PRIMARY KEY,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT
            );
            
[2025-02-27T10:59:31.500+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T10:59:31.632+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T10:59:31.635+0000] {sql.py:375} INFO - Running statement: 
            CREATE TABLE IF NOT EXISTS velib_stations(
                station_id BIGINT PRIMARY KEY,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT
            );
            , parameters: None
[2025-02-27T10:59:31.651+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T105931, end_date=20250227T105931
[2025-02-27T10:59:31.696+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T10:59:31.721+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T11:13:55.375+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:13:55.385+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:13:55.387+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T11:13:55.396+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T11:13:55.399+0000] {standard_task_runner.py:57} INFO - Started process 226 to run task
[2025-02-27T11:13:55.403+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpppp0_2z8']
[2025-02-27T11:13:55.405+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T11:13:55.471+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 4e453fff3cdd
[2025-02-27T11:13:55.552+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T11:13:55.553+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T11:13:55.564+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:13:55.695+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:13:55.700+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T11:13:55.709+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE

[2025-02-27T11:13:55.715+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T111355, end_date=20250227T111355
[2025-02-27T11:13:55.722+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE
; 226)
[2025-02-27T11:13:55.748+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T11:13:55.763+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T11:39:44.483+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:39:44.490+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:39:44.490+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T11:39:44.498+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T11:39:44.503+0000] {standard_task_runner.py:57} INFO - Started process 189 to run task
[2025-02-27T11:39:44.505+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpqvlj7set']
[2025-02-27T11:39:44.509+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T11:39:44.587+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a00cf8e93560
[2025-02-27T11:39:44.669+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T11:39:44.670+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T11:39:44.681+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:39:44.805+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:39:44.811+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T11:39:44.817+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE

[2025-02-27T11:39:44.825+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T113944, end_date=20250227T113944
[2025-02-27T11:39:44.834+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE
; 189)
[2025-02-27T11:39:44.855+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T11:39:44.877+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T11:49:08.262+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:49:08.270+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:49:08.271+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T11:49:08.282+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T11:49:08.290+0000] {standard_task_runner.py:57} INFO - Started process 183 to run task
[2025-02-27T11:49:08.292+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpiql4n347']
[2025-02-27T11:49:08.294+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T11:49:08.419+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 08791af1fcb0
[2025-02-27T11:49:08.522+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T11:49:08.523+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T11:49:08.535+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:49:08.706+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:49:08.712+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T11:49:08.733+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T114908, end_date=20250227T114908
[2025-02-27T11:49:08.777+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T11:49:08.806+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T11:59:46.337+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:59:46.349+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T11:59:46.350+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T11:59:46.366+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T11:59:46.371+0000] {standard_task_runner.py:57} INFO - Started process 211 to run task
[2025-02-27T11:59:46.378+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpmafresl9']
[2025-02-27T11:59:46.380+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T11:59:46.523+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 8e4c40b4e563
[2025-02-27T11:59:46.746+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T11:59:46.759+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T11:59:46.783+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:59:46.930+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T11:59:46.944+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T11:59:46.975+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T115946, end_date=20250227T115946
[2025-02-27T11:59:47.011+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T11:59:47.042+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T12:08:02.853+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:08:02.862+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:08:02.862+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T12:08:02.872+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T12:08:02.877+0000] {standard_task_runner.py:57} INFO - Started process 178 to run task
[2025-02-27T12:08:02.880+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpbf95c4bq']
[2025-02-27T12:08:02.883+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T12:08:02.953+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host d2a66760e739
[2025-02-27T12:08:03.052+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T12:08:03.053+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T12:08:03.061+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:08:03.184+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:08:03.188+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T12:08:03.206+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T120802, end_date=20250227T120803
[2025-02-27T12:08:03.224+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T12:08:03.284+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T12:23:27.091+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:23:27.100+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:23:27.100+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T12:23:27.111+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T12:23:27.115+0000] {standard_task_runner.py:57} INFO - Started process 181 to run task
[2025-02-27T12:23:27.117+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpl09isjs2']
[2025-02-27T12:23:27.119+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T12:23:27.169+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 0972c516a0af
[2025-02-27T12:23:27.240+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T12:23:27.240+0000] {sql.py:262} INFO - Executing: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            
[2025-02-27T12:23:27.246+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:23:27.371+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:23:27.376+0000] {sql.py:375} INFO - Running statement: 
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT 1 FROM information_schema.tables 
                    WHERE table_schema = 'public' AND table_name = 'velib_stations'
                ) THEN
                    -- Si la table n'existe pas, on s'assure que le type composite n'existe pas non plus
                    IF EXISTS (
                        SELECT 1 FROM pg_type WHERE typname = 'velib_stations'
                    ) THEN
                        EXECUTE 'DROP TYPE velib_stations CASCADE';
                    END IF;
                    EXECUTE '
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    ';
                END IF;
            END
            $$;

            , parameters: None
[2025-02-27T12:23:27.386+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE

[2025-02-27T12:23:27.393+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T122327, end_date=20250227T122327
[2025-02-27T12:23:27.403+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                        CREATE TABLE velib_stations(
                            station_id BIGINT PRIMARY KEY,
                            is_installed INT,
                            is_renting INT,
                            is_returning INT,
                            last_reported TIMESTAMP,
                            numBikesAvailable INT,
                            numDocksAvailable INT,
                            num_bikes_available INT,
                            num_ebikes_available INT,
                            num_mechanical_bikes_available INT,
                            num_docks_available INT
                        )
                    "
PL/pgSQL function inline_code_block line 13 at EXECUTE
; 181)
[2025-02-27T12:23:27.421+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T12:23:27.440+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T12:38:07.509+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:38:07.514+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:38:07.514+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T12:38:07.524+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T12:38:07.527+0000] {standard_task_runner.py:57} INFO - Started process 179 to run task
[2025-02-27T12:38:07.530+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpa2olqh2k']
[2025-02-27T12:38:07.532+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T12:38:07.585+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 493d37524ffa
[2025-02-27T12:38:07.636+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T12:38:07.637+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T12:38:07.643+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:38:07.750+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:38:07.753+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T12:38:07.782+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T123807, end_date=20250227T123807
[2025-02-27T12:38:07.831+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T12:38:07.864+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T12:41:18.833+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:41:18.844+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T12:41:18.844+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T12:41:18.856+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T12:41:18.860+0000] {standard_task_runner.py:57} INFO - Started process 178 to run task
[2025-02-27T12:41:18.865+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpc6ep12pb']
[2025-02-27T12:41:18.867+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T12:41:18.921+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 94f4382ac0ba
[2025-02-27T12:41:18.986+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T12:41:18.987+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T12:41:18.994+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:41:19.121+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T12:41:19.124+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T12:41:19.141+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T124118, end_date=20250227T124119
[2025-02-27T12:41:19.171+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T12:41:19.194+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:16:20.217+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:16:20.233+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:16:20.233+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:16:20.242+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:16:20.247+0000] {standard_task_runner.py:57} INFO - Started process 208 to run task
[2025-02-27T13:16:20.252+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpbfk5gbc8']
[2025-02-27T13:16:20.254+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T13:16:20.298+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 3f89a3e69849
[2025-02-27T13:16:20.391+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:16:20.391+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:16:20.398+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:16:20.521+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:16:20.526+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:16:20.537+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE

[2025-02-27T13:16:20.544+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T131620, end_date=20250227T131620
[2025-02-27T13:16:20.554+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE
; 208)
[2025-02-27T13:16:20.593+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:16:20.613+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:19:50.672+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:19:50.679+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:19:50.680+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:19:50.691+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:19:50.696+0000] {standard_task_runner.py:57} INFO - Started process 177 to run task
[2025-02-27T13:19:50.699+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp9_porkd2']
[2025-02-27T13:19:50.702+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T13:19:50.787+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 1769bb992e56
[2025-02-27T13:19:50.879+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:19:50.879+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:19:50.885+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:19:51.010+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:19:51.014+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:19:51.028+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE

[2025-02-27T13:19:51.035+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T131950, end_date=20250227T131951
[2025-02-27T13:19:51.046+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE
; 177)
[2025-02-27T13:19:51.085+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:19:51.108+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:22:33.804+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:22:33.809+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:22:33.811+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:22:33.819+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:22:33.822+0000] {standard_task_runner.py:57} INFO - Started process 179 to run task
[2025-02-27T13:22:33.825+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpyf681z5y']
[2025-02-27T13:22:33.827+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T13:22:33.877+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host f51c37a32fa6
[2025-02-27T13:22:33.933+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:22:33.935+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:22:33.947+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:22:34.072+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:22:34.076+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:22:34.086+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE

[2025-02-27T13:22:34.093+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T132233, end_date=20250227T132234
[2025-02-27T13:22:34.100+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 4 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE
; 179)
[2025-02-27T13:22:34.127+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:22:34.143+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:33:11.887+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:33:11.897+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:33:11.897+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:33:11.912+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:33:11.923+0000] {standard_task_runner.py:57} INFO - Started process 184 to run task
[2025-02-27T13:33:11.939+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpcmq3vbzs']
[2025-02-27T13:33:11.943+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T13:33:11.993+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 302ea8356a15
[2025-02-27T13:33:12.056+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:33:12.059+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:33:12.065+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:33:12.170+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:33:12.174+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:33:12.184+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE

[2025-02-27T13:33:12.189+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T133311, end_date=20250227T133312
[2025-02-27T13:33:12.200+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE
; 184)
[2025-02-27T13:33:12.204+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:33:12.220+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:50:51.469+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:50:51.475+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:50:51.476+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:50:51.484+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:50:51.488+0000] {standard_task_runner.py:57} INFO - Started process 182 to run task
[2025-02-27T13:50:51.491+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp0baa_c8q']
[2025-02-27T13:50:51.493+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T13:50:51.542+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 0dc2b4101260
[2025-02-27T13:50:51.609+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:50:51.609+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:50:51.617+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:50:51.729+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:50:51.732+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:50:51.748+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE

[2025-02-27T13:50:51.758+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T135051, end_date=20250227T135051
[2025-02-27T13:50:51.765+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                "
PL/pgSQL function inline_code_block line 12 at EXECUTE
; 182)
[2025-02-27T13:50:51.794+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:50:51.813+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T13:58:12.719+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:58:12.727+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T13:58:12.728+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T13:58:12.737+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T13:58:12.746+0000] {standard_task_runner.py:57} INFO - Started process 189 to run task
[2025-02-27T13:58:12.750+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpn8b88iby']
[2025-02-27T13:58:12.753+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T13:58:12.832+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 90fb001151ab
[2025-02-27T13:58:12.904+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T13:58:12.905+0000] {sql.py:262} INFO - Executing: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    
[2025-02-27T13:58:12.911+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:58:13.033+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T13:58:13.038+0000] {sql.py:375} INFO - Running statement: 
        DO $$
        BEGIN
            -- Vérifiez d'abord si le type existe et le supprimer
            IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'velib_stations') THEN
                EXECUTE 'DROP TYPE IF EXISTS velib_stations CASCADE';
            END IF;
            -- Ensuite, créez la table si elle n'existe pas
            IF NOT EXISTS (
                SELECT 1 FROM information_schema.tables 
                WHERE table_schema = 'public' AND table_name = 'velib_stations'
            ) THEN
                EXECUTE '
                    CREATE TABLE velib_stations(
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                ';
            END IF;
        END
        $$;
    , parameters: None
[2025-02-27T13:58:13.041+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.DependentObjectsStillExist: cannot drop type velib_stations because table velib_stations requires it
HINT:  You can drop table velib_stations instead.
CONTEXT:  SQL statement "DROP TYPE IF EXISTS velib_stations CASCADE"
PL/pgSQL function inline_code_block line 5 at EXECUTE

[2025-02-27T13:58:13.048+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T135812, end_date=20250227T135813
[2025-02-27T13:58:13.056+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (cannot drop type velib_stations because table velib_stations requires it
HINT:  You can drop table velib_stations instead.
CONTEXT:  SQL statement "DROP TYPE IF EXISTS velib_stations CASCADE"
PL/pgSQL function inline_code_block line 5 at EXECUTE
; 189)
[2025-02-27T13:58:13.100+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T13:58:13.118+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T14:03:45.446+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:03:45.453+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:03:45.454+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T14:03:45.464+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T14:03:45.469+0000] {standard_task_runner.py:57} INFO - Started process 182 to run task
[2025-02-27T14:03:45.473+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpcjxx_tez']
[2025-02-27T14:03:45.477+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T14:03:45.550+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 5b8533a39e96
[2025-02-27T14:03:45.626+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T14:03:45.627+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    
[2025-02-27T14:03:45.634+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:03:45.796+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:03:45.802+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    , parameters: None
[2025-02-27T14:03:45.808+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T14:03:45.816+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T140345, end_date=20250227T140345
[2025-02-27T14:03:45.823+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 4 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 182)
[2025-02-27T14:03:45.859+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T14:03:45.885+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T14:17:26.690+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:17:26.695+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:17:26.695+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T14:17:26.704+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T14:17:26.708+0000] {standard_task_runner.py:57} INFO - Started process 195 to run task
[2025-02-27T14:17:26.711+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpy20o8x6o']
[2025-02-27T14:17:26.714+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T14:17:26.779+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host c6d37e3f50d8
[2025-02-27T14:17:26.873+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T14:17:26.876+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    
[2025-02-27T14:17:26.886+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:17:27.045+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:17:27.050+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    , parameters: None
[2025-02-27T14:17:27.057+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T14:17:27.083+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T141726, end_date=20250227T141727
[2025-02-27T14:17:27.090+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 195)
[2025-02-27T14:17:27.097+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T14:17:27.137+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T14:24:45.216+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:24:45.222+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:24:45.222+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T14:24:45.231+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T14:24:45.237+0000] {standard_task_runner.py:57} INFO - Started process 187 to run task
[2025-02-27T14:24:45.240+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp7tcb5eep']
[2025-02-27T14:24:45.242+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T14:24:45.304+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host dc3a30e27f13
[2025-02-27T14:24:45.366+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T14:24:45.367+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    
[2025-02-27T14:24:45.372+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:24:45.488+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:24:45.491+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DROP TABLE IF EXISTS velib_stations CASCADE;
            CREATE TABLE velib_stations(
                station_id BIGINT,
                is_installed INT,
                is_renting INT,
                is_returning INT,
                last_reported TIMESTAMP,
                numBikesAvailable INT,
                numDocksAvailable INT,
                num_bikes_available INT,
                num_ebikes_available INT,
                num_mechanical_bikes_available INT,
                num_docks_available INT,
                PRIMARY KEY (station_id, last_reported)
            );
        COMMIT;
    , parameters: None
[2025-02-27T14:24:45.498+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T14:24:45.503+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T142445, end_date=20250227T142445
[2025-02-27T14:24:45.510+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 3 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 187)
[2025-02-27T14:24:45.547+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T14:24:45.584+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T14:30:56.367+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:30:56.373+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:30:56.373+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T14:30:56.382+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T14:30:56.386+0000] {standard_task_runner.py:57} INFO - Started process 185 to run task
[2025-02-27T14:30:56.389+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpyvr1fzta']
[2025-02-27T14:30:56.391+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T14:30:56.446+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a552db7362e5
[2025-02-27T14:30:56.507+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T14:30:56.509+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    
[2025-02-27T14:30:56.514+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:30:56.643+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:30:56.647+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    , parameters: None
[2025-02-27T14:30:56.657+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T143056, end_date=20250227T143056
[2025-02-27T14:30:56.694+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T14:30:56.730+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T14:51:50.373+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:51:50.379+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T14:51:50.379+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T14:51:50.388+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T14:51:50.392+0000] {standard_task_runner.py:57} INFO - Started process 273 to run task
[2025-02-27T14:51:50.395+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp7cr6fjxo']
[2025-02-27T14:51:50.399+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T14:51:50.484+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host b6fe49d0fb59
[2025-02-27T14:51:50.652+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T14:51:50.655+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    
[2025-02-27T14:51:50.666+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:51:50.785+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T14:51:50.793+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    , parameters: None
[2025-02-27T14:51:50.814+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T145150, end_date=20250227T145150
[2025-02-27T14:51:50.860+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T14:51:50.887+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T15:08:23.511+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:08:23.517+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:08:23.517+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T15:08:23.526+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T15:08:23.529+0000] {standard_task_runner.py:57} INFO - Started process 177 to run task
[2025-02-27T15:08:23.531+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpt0p0anrh']
[2025-02-27T15:08:23.533+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T15:08:23.593+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 0177d843a7c4
[2025-02-27T15:08:23.668+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T15:08:23.669+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    
[2025-02-27T15:08:23.676+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:08:23.799+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:08:23.803+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (
                    SELECT FROM pg_tables 
                    WHERE schemaname = 'public' 
                    AND tablename = 'velib_stations'
                ) THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    , parameters: None
[2025-02-27T15:08:23.818+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T150823, end_date=20250227T150823
[2025-02-27T15:08:23.835+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T15:08:23.854+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T15:11:26.049+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:11:26.054+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:11:26.054+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T15:11:26.070+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T15:11:26.072+0000] {standard_task_runner.py:57} INFO - Started process 180 to run task
[2025-02-27T15:11:26.076+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpn57drgyr']
[2025-02-27T15:11:26.078+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T15:11:26.127+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 8d4390e24c8f
[2025-02-27T15:11:26.190+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T15:11:26.191+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'velib_stations') THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    
[2025-02-27T15:11:26.197+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:11:26.305+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:11:26.310+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'velib_stations') THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    , parameters: None
[2025-02-27T15:11:26.321+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    )"
PL/pgSQL function inline_code_block line 4 at SQL statement

[2025-02-27T15:11:26.326+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T151126, end_date=20250227T151126
[2025-02-27T15:11:26.334+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
CONTEXT:  SQL statement "CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    )"
PL/pgSQL function inline_code_block line 4 at SQL statement
; 180)
[2025-02-27T15:11:26.377+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T15:11:26.402+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T15:42:20.972+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:42:20.978+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:42:20.978+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T15:42:20.987+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T15:42:20.992+0000] {standard_task_runner.py:57} INFO - Started process 176 to run task
[2025-02-27T15:42:20.996+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpnbsbluo9']
[2025-02-27T15:42:21.000+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T15:42:21.059+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 0d5c9f65f64a
[2025-02-27T15:42:21.114+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T15:42:21.116+0000] {sql.py:262} INFO - Executing: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'velib_stations') THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    
[2025-02-27T15:42:21.121+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:42:21.239+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:42:21.243+0000] {sql.py:375} INFO - Running statement: 
        BEGIN;
            DO $$
            BEGIN
                IF NOT EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'velib_stations') THEN
                    CREATE TABLE public.velib_stations (
                        station_id BIGINT,
                        is_installed INT,
                        is_renting INT,
                        is_returning INT,
                        last_reported TIMESTAMP,
                        numBikesAvailable INT,
                        numDocksAvailable INT,
                        num_bikes_available INT,
                        num_ebikes_available INT,
                        num_mechanical_bikes_available INT,
                        num_docks_available INT,
                        PRIMARY KEY (station_id, last_reported)
                    );
                END IF;
            END
            $$;
        COMMIT;

    , parameters: None
[2025-02-27T15:42:21.259+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T154220, end_date=20250227T154221
[2025-02-27T15:42:21.302+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T15:42:21.333+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T15:50:24.370+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:50:24.376+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:50:24.376+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T15:50:24.384+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T15:50:24.389+0000] {standard_task_runner.py:57} INFO - Started process 181 to run task
[2025-02-27T15:50:24.392+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp9gd7awy3']
[2025-02-27T15:50:24.393+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T15:50:24.446+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host b95c8530fb6c
[2025-02-27T15:50:24.507+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T15:50:24.508+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T15:50:24.514+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:50:24.622+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:50:24.626+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T15:50:24.632+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T15:50:24.644+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T155024, end_date=20250227T155024
[2025-02-27T15:50:24.661+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 3 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 181)
[2025-02-27T15:50:24.693+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T15:50:24.712+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T15:53:07.784+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:53:07.789+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T15:53:07.789+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T15:53:07.798+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T15:53:07.803+0000] {standard_task_runner.py:57} INFO - Started process 178 to run task
[2025-02-27T15:53:07.807+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp1qsoq4tk']
[2025-02-27T15:53:07.809+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T15:53:07.859+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host f5aed095ee09
[2025-02-27T15:53:07.927+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T15:53:07.928+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T15:53:07.935+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:53:08.054+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T15:53:08.059+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T15:53:08.075+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T155307, end_date=20250227T155308
[2025-02-27T15:53:08.108+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T15:53:08.142+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:06:30.076+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:06:30.082+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:06:30.082+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:06:30.094+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:06:30.101+0000] {standard_task_runner.py:57} INFO - Started process 179 to run task
[2025-02-27T16:06:30.104+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpo7cirpvb']
[2025-02-27T16:06:30.107+0000] {standard_task_runner.py:85} INFO - Job 5: Subtask create_velib_station_status_table
[2025-02-27T16:06:30.169+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 70227d8e9381
[2025-02-27T16:06:30.293+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:06:30.296+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:06:30.308+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:06:30.442+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:06:30.446+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:06:30.464+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T160630, end_date=20250227T160630
[2025-02-27T16:06:30.494+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:06:30.523+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:20:02.577+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:20:02.585+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:20:02.585+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:20:02.594+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:20:02.598+0000] {standard_task_runner.py:57} INFO - Started process 177 to run task
[2025-02-27T16:20:02.601+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpj5896vwk']
[2025-02-27T16:20:02.603+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T16:20:02.669+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host e84fbebffd18
[2025-02-27T16:20:02.729+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:20:02.730+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:20:02.735+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:20:02.867+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:20:02.874+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:20:02.886+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T162002, end_date=20250227T162002
[2025-02-27T16:20:02.907+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:20:02.926+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:27:35.365+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:27:35.371+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:27:35.371+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:27:35.382+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:27:35.389+0000] {standard_task_runner.py:57} INFO - Started process 180 to run task
[2025-02-27T16:27:35.393+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpyfhnklqe']
[2025-02-27T16:27:35.395+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T16:27:35.457+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 256910fe3a65
[2025-02-27T16:27:35.538+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:27:35.539+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:27:35.546+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:27:35.679+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:27:35.683+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:27:35.702+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T16:27:35.709+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T162735, end_date=20250227T162735
[2025-02-27T16:27:35.717+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 4 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 180)
[2025-02-27T16:27:35.737+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T16:27:35.755+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:34:49.858+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:34:49.863+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:34:49.863+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:34:49.871+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:34:49.877+0000] {standard_task_runner.py:57} INFO - Started process 179 to run task
[2025-02-27T16:34:49.879+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp3_wm_fkb']
[2025-02-27T16:34:49.882+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T16:34:49.946+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 3392905e5c72
[2025-02-27T16:34:50.023+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:34:50.023+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:34:50.030+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:34:50.152+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:34:50.156+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:34:50.162+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T16:34:50.167+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T163449, end_date=20250227T163450
[2025-02-27T16:34:50.173+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 179)
[2025-02-27T16:34:50.183+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T16:34:50.214+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:42:12.358+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:42:12.363+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:42:12.364+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:42:12.372+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:42:12.377+0000] {standard_task_runner.py:57} INFO - Started process 180 to run task
[2025-02-27T16:42:12.380+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpa4uln8zq']
[2025-02-27T16:42:12.381+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T16:42:12.437+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 0cb13b06ea45
[2025-02-27T16:42:12.513+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:42:12.513+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:42:12.519+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:42:12.631+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:42:12.634+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:42:12.657+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T164212, end_date=20250227T164212
[2025-02-27T16:42:12.684+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:42:12.716+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:47:37.738+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:47:37.746+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:47:37.746+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:47:37.756+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:47:37.760+0000] {standard_task_runner.py:57} INFO - Started process 180 to run task
[2025-02-27T16:47:37.763+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpe2pmhkl5']
[2025-02-27T16:47:37.764+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T16:47:37.815+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 357b585475c9
[2025-02-27T16:47:37.887+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:47:37.888+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:47:37.895+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:47:38.021+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:47:38.023+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:47:38.036+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T164737, end_date=20250227T164738
[2025-02-27T16:47:38.066+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:47:38.104+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:53:41.318+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:53:41.324+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:53:41.324+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:53:41.333+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:53:41.338+0000] {standard_task_runner.py:57} INFO - Started process 178 to run task
[2025-02-27T16:53:41.343+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpwnd7mulb']
[2025-02-27T16:53:41.351+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T16:53:41.401+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a0bfba191c0c
[2025-02-27T16:53:41.469+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:53:41.470+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:53:41.479+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:53:41.612+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:53:41.616+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:53:41.621+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T16:53:41.626+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T165341, end_date=20250227T165341
[2025-02-27T16:53:41.635+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 4 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 178)
[2025-02-27T16:53:41.644+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T16:53:41.661+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:54:35.427+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:54:35.432+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:54:35.432+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:54:35.440+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:54:35.444+0000] {standard_task_runner.py:57} INFO - Started process 332 to run task
[2025-02-27T16:54:35.446+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp64vs8w0r']
[2025-02-27T16:54:35.448+0000] {standard_task_runner.py:85} INFO - Job 12: Subtask create_velib_station_status_table
[2025-02-27T16:54:35.497+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a0bfba191c0c
[2025-02-27T16:54:35.559+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:54:35.560+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:54:35.568+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:54:35.621+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:54:35.624+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:54:35.631+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T165435, end_date=20250227T165435
[2025-02-27T16:54:35.669+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:54:35.704+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T16:55:05.810+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:55:05.816+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T16:55:05.816+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T16:55:05.823+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T16:55:05.826+0000] {standard_task_runner.py:57} INFO - Started process 479 to run task
[2025-02-27T16:55:05.829+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpq1gqxp6c']
[2025-02-27T16:55:05.830+0000] {standard_task_runner.py:85} INFO - Job 18: Subtask create_velib_station_status_table
[2025-02-27T16:55:05.878+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a0bfba191c0c
[2025-02-27T16:55:05.927+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T16:55:05.928+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T16:55:05.933+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:55:05.987+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T16:55:05.989+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T16:55:05.995+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T165505, end_date=20250227T165505
[2025-02-27T16:55:06.008+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T16:55:06.026+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T17:12:09.260+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:12:09.265+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:12:09.266+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T17:12:09.274+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T17:12:09.278+0000] {standard_task_runner.py:57} INFO - Started process 179 to run task
[2025-02-27T17:12:09.281+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpv47rxx1y']
[2025-02-27T17:12:09.283+0000] {standard_task_runner.py:85} INFO - Job 2: Subtask create_velib_station_status_table
[2025-02-27T17:12:09.333+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host f4e90ab2c82e
[2025-02-27T17:12:09.429+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T17:12:09.429+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T17:12:09.438+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:12:09.598+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:12:09.611+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T17:12:09.620+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T17:12:09.628+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T171209, end_date=20250227T171209
[2025-02-27T17:12:09.638+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 2 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 179)
[2025-02-27T17:12:09.671+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T17:12:09.711+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T17:21:46.663+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:21:46.669+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:21:46.672+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T17:21:46.680+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T17:21:46.684+0000] {standard_task_runner.py:57} INFO - Started process 177 to run task
[2025-02-27T17:21:46.687+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp5168nd3a']
[2025-02-27T17:21:46.689+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T17:21:46.738+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host a103a973a33d
[2025-02-27T17:21:46.801+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T17:21:46.802+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T17:21:46.809+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:21:46.930+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:21:46.935+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T17:21:46.941+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T17:21:46.946+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T172146, end_date=20250227T172146
[2025-02-27T17:21:46.954+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 3 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 177)
[2025-02-27T17:21:46.990+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T17:21:47.007+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T17:27:25.050+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:27:25.058+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T17:27:25.058+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T17:27:25.076+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T17:27:25.086+0000] {standard_task_runner.py:57} INFO - Started process 177 to run task
[2025-02-27T17:27:25.089+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmparwpveas']
[2025-02-27T17:27:25.091+0000] {standard_task_runner.py:85} INFO - Job 3: Subtask create_velib_station_status_table
[2025-02-27T17:27:25.157+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 6787c35814a1
[2025-02-27T17:27:25.231+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T17:27:25.232+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T17:27:25.238+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:27:25.357+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T17:27:25.360+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T17:27:25.372+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T17:27:25.388+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T172725, end_date=20250227T172725
[2025-02-27T17:27:25.401+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 3 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 177)
[2025-02-27T17:27:25.436+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T17:27:25.453+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-27T19:14:27.541+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T19:14:27.547+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T19:14:27.547+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T19:14:27.555+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T19:14:27.561+0000] {standard_task_runner.py:57} INFO - Started process 1114 to run task
[2025-02-27T19:14:27.563+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpklhx9bfg']
[2025-02-27T19:14:27.565+0000] {standard_task_runner.py:85} INFO - Job 19: Subtask create_velib_station_status_table
[2025-02-27T19:14:27.636+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 6787c35814a1
[2025-02-27T19:14:27.708+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T19:14:27.709+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T19:14:27.717+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T19:14:27.774+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T19:14:27.778+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T19:14:27.784+0000] {taskinstance.py:1373} INFO - Marking task as SUCCESS. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T191427, end_date=20250227T191427
[2025-02-27T19:14:27.797+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-02-27T19:14:27.815+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-02-27T19:18:01.124+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T19:18:01.129+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [queued]>
[2025-02-27T19:18:01.129+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-02-27T19:18:01.137+0000] {taskinstance.py:1350} INFO - Executing <Task(PostgresOperator): create_velib_station_status_table> on 2025-02-26 00:00:00+00:00
[2025-02-27T19:18:01.141+0000] {standard_task_runner.py:57} INFO - Started process 180 to run task
[2025-02-27T19:18:01.147+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'api_to_db_dag', 'create_velib_station_status_table', 'scheduled__2025-02-26T00:00:00+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmpkaubzrmz']
[2025-02-27T19:18:01.149+0000] {standard_task_runner.py:85} INFO - Job 4: Subtask create_velib_station_status_table
[2025-02-27T19:18:01.197+0000] {task_command.py:410} INFO - Running <TaskInstance: api_to_db_dag.create_velib_station_status_table scheduled__2025-02-26T00:00:00+00:00 [running]> on host 4ff83f64f86f
[2025-02-27T19:18:01.282+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='api_to_db_dag' AIRFLOW_CTX_TASK_ID='create_velib_station_status_table' AIRFLOW_CTX_EXECUTION_DATE='2025-02-26T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-02-26T00:00:00+00:00'
[2025-02-27T19:18:01.283+0000] {sql.py:262} INFO - Executing: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    
[2025-02-27T19:18:01.289+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T19:18:01.412+0000] {base.py:73} INFO - Using connection ID 'postgres_default' for task execution.
[2025-02-27T19:18:01.417+0000] {sql.py:375} INFO - Running statement: 
        CREATE TABLE IF NOT EXISTS public.velib_stations (
        station_id BIGINT,
        is_installed INT,
        is_renting INT,
        is_returning INT,
        last_reported TIMESTAMP,
        numBikesAvailable INT,
        numDocksAvailable INT,
        num_bikes_available INT,
        num_ebikes_available INT,
        num_mechanical_bikes_available INT,
        num_docks_available INT,
        PRIMARY KEY (station_id, last_reported)
    );
    , parameters: None
[2025-02-27T19:18:01.432+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/operators/sql.py", line 274, in execute
    **extra_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 349, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/common/sql/hooks/sql.py", line 380, in _run_command
    cur.execute(sql_statement)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.

[2025-02-27T19:18:01.438+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=api_to_db_dag, task_id=create_velib_station_status_table, execution_date=20250226T000000, start_date=20250227T191801, end_date=20250227T191801
[2025-02-27T19:18:01.446+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 4 for task create_velib_station_status_table (duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(velib_stations, 2200) already exists.
; 180)
[2025-02-27T19:18:01.488+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-02-27T19:18:01.517+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
